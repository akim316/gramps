(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{380:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return s})),n.d(t,"default",(function(){return u}));n(11),n(5),n(6),n(2),n(10),n(1),n(0);var a=n(103),r=n(393);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var s={},c=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(a.b)("div",t)}},i=c("AnchorLinks"),l=c("AnchorLink"),b={_frontmatter:s},p=r.a;function u(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,["components"]);return Object(a.b)(p,o({},b,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"Now that we’ve ",Object(a.b)("a",o({parentName:"p"},{href:"/data-source-tutorial/setup"}),"set up the data source"),", we can start building the data source itself. In this section, we’ll tell the data source where data should come from."),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},Object(a.b)("strong",{parentName:"p"},"NOTE:")," This example accesses data from a REST API, but the data could also\ncome from a database or, really, anywhere that can give a response we can\nconvert to JSON.")),Object(a.b)("h2",{id:"table-of-contents"},"Table of Contents"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"/data-source-tutorial/setup"}),"Initial Data Source Setup")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("strong",{parentName:"li"},"> ",Object(a.b)("a",o({parentName:"strong"},{href:"/data-source-tutorial/connector"}),"Create a Connector"))),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"/data-source-tutorial/model"}),"Create a Model")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"/data-source-tutorial/schema"}),"Write a GraphQL Schema")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"/data-source-tutorial/resolvers"}),"Write Resolvers")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"/data-source-tutorial/dev"}),"Use Development Modes"))),Object(a.b)("h2",{id:"in-this-section"},"In This Section"),Object(a.b)(i,{mdxType:"AnchorLinks"},Object(a.b)(l,{mdxType:"AnchorLink"},"Create Your Connector"),Object(a.b)(l,{mdxType:"AnchorLink"},"Write Tests for the Connector")),Object(a.b)("h2",{id:"create-your-connector"},"Create Your Connector"),Object(a.b)("p",null,"The first code change we need to make is to update the Connector to point to the API we want to use. This class sets up the requests themselves, plus helpers to enable caching."),Object(a.b)("p",null,"In ",Object(a.b)("inlineCode",{parentName:"p"},"src/connector.js"),", make the following change:"),Object(a.b)("pre",null,Object(a.b)("code",o({parentName:"pre"},{className:"language-diff"}),"  import { GraphQLConnector } from '@gramps/gramps-express';\n\n- // TODO: change `YourDataSourceConnector` to a descriptive name\n- export default class YourDataSourceConnector extends GraphQLConnector {\n+ export default class IMDBAPIConnector extends GraphQLConnector {\n    /**\n-    * TODO: describe this API endpoint\n+    * API for looking up movie info\n     * @member {string}\n     */\n-   apiBaseUri = `https://example.org/v2`;\n+   apiBaseUri = `https://www.theimdbapi.org/api`;\n  }\n")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},Object(a.b)("strong",{parentName:"p"},"NOTE:")," The ",Object(a.b)("inlineCode",{parentName:"p"},"GraphQLConnector")," class sets up a lot of core functionality in\nthe background, including methods for sending queries and mutations, plus\nhelpers for caching data. For more information on what’s happening behind the\nscenes, see ",Object(a.b)("a",o({parentName:"p"},{href:"https://git.io/vdQzQ"}),"the source code"),".")),Object(a.b)("h2",{id:"write-tests-for-the-connector"},"Write Tests for the Connector"),Object(a.b)("p",null,"Next, update the tests for the connector by making the changes below in ",Object(a.b)("inlineCode",{parentName:"p"},"test/connector.test.js"),":"),Object(a.b)("pre",null,Object(a.b)("code",o({parentName:"pre"},{className:"language-diff"}),"  import { GraphQLConnector } from '@gramps/gramps-express';\n  import Connector from '../src/connector';\n\n- // TODO: Update the data source name.\n- const DATA_SOURCE_NAME = 'YourDataSource';\n+ const DATA_SOURCE_NAME = 'IMDBAPI';\n  const connector = new Connector();\n\n  describe(`${DATA_SOURCE_NAME}Connector`, () => {\n    it('inherits the GraphQLConnector class', () => {\n      expect(connector).toBeInstanceOf(GraphQLConnector);\n    });\n\n    it('uses the appropriate URL', () => {\n-     // TODO: Update the data source API endpoint.\n-     expect(connector.apiBaseUri).toBe(`https://example.org/v2`);\n+     expect(connector.apiBaseUri).toBe(`https://www.theimdbapi.org/api`);\n    });\n  });\n")),Object(a.b)("p",null,"Verify that this works by running ",Object(a.b)("inlineCode",{parentName:"p"},"yarn test"),". Everything should pass:"),Object(a.b)("pre",null,Object(a.b)("code",o({parentName:"pre"},{}),"@jlengstorf: ~/dev/gramps-graphql/data-source-imdbapi  (master)\n$ yarn test\nyarn run v1.2.1\n$ npm run lint --silent && npm run test:unit --silent\n PASS  test/resolvers.test.js\n PASS  test/connector.test.js\n PASS  test/model.test.js\n PASS  test/index.test.js\n\nTest Suites: 4 passed, 4 total\nTests:       16 passed, 16 total\nSnapshots:   0 total\nTime:        1.839s\nRan all test suites.\n--------------|----------|----------|----------|----------|----------------|\nFile          |  % Stmts | % Branch |  % Funcs |  % Lines |Uncovered Lines |\n--------------|----------|----------|----------|----------|----------------|\nAll files     |      100 |      100 |      100 |      100 |                |\n connector.js |      100 |      100 |      100 |      100 |                |\n index.js     |      100 |      100 |      100 |      100 |                |\n model.js     |      100 |      100 |      100 |      100 |                |\n resolvers.js |      100 |      100 |      100 |      100 |                |\n--------------|----------|----------|----------|----------|----------------|\n✨  Done in 4.83s.\n")),Object(a.b)("h2",{id:"next-up-create-a-model"},"Next Up: Create a Model"),Object(a.b)("p",null,"Hey! That wasn’t bad, right? In the next section, we’ll show our data source how to access data by defining data access methods in the model."))}u.isMDXComponent=!0},391:function(e){e.exports=JSON.parse('{"data":{"site":{"pathPrefix":""}}}')},392:function(e){e.exports=JSON.parse('{"data":{"site":{"siteMetadata":{"repository":{"baseUrl":"","subDirectory":""}}}}}')},393:function(e,t,n){"use strict";n(35),n(27);var a=n(1),r=n(391),o=n(0),s=n.n(o),c=n(102),i=n.n(c),l=n(187),b=n(121),p=n(3),u=n.n(p),d=n(372),h=function(e){var t,n=e.title,r=e.tabs,o=void 0===r?[]:r;return Object(a.b)("div",{className:u()(d.pageHeader,(t={},t[d.withTabs]=o.length,t))},Object(a.b)("div",{className:"bx--grid"},Object(a.b)("div",{className:"bx--row"},Object(a.b)("div",{className:"bx--col-lg-12"},Object(a.b)("h1",{id:"page-title",className:d.text},n)))))},m=n(392),O=n(373),j=function(e){var t=e.relativePagePath,n=e.repository,r=m.data.site.siteMetadata.repository,o=n||r,s=o.baseUrl,c=s+"/tree/master"+o.subDirectory+"/src/pages"+t;return s?Object(a.b)("div",{className:"bx--row "+O.row},Object(a.b)("div",{className:"bx--col"},Object(a.b)("a",{className:O.link,href:c},"Edit this page on GitHub"))):null},f=n(186),g=n(28),N=n(374);var v=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r.prototype.render=function(){var e=this.props,t=e.tabs,n=e.slug,r=n.split("/").filter(Boolean).slice(-1)[0],o=t.map((function(e){var t,o=i()(e,{lower:!0}),s=o===r,c=n.replace(r,o);return Object(a.b)("li",{key:e,className:u()((t={},t[N.selectedItem]=s,t),N.listItem)},Object(a.b)(g.Link,{className:N.link,to:""+c},e))}));return Object(a.b)("div",{className:N.tabsContainer},Object(a.b)("div",{className:"bx--grid"},Object(a.b)("div",{className:"bx--row"},Object(a.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(a.b)("nav",null,Object(a.b)("ul",{className:N.list},o))))))},r}(s.a.Component),w=n(188);t.a=function(e){var t=e.pageContext,n=e.children,o=e.location,s=t.frontmatter,c=void 0===s?{}:s,p=t.relativePagePath,u=t.titleType,d=c.tabs,m=c.title,O=c.theme,g=c.description,N=c.keywords,x=r.data.site.pathPrefix,y=x?o.pathname.replace(x,""):o.pathname,C=d?y.split("/").slice(-1)[0]||i()(d[0],{lower:!0}):"";return Object(a.b)(b.a,{homepage:!1,theme:O,pageTitle:m,pageDescription:g,pageKeywords:N,titleType:u},Object(a.b)(h,{title:m,label:"label",tabs:d}),d&&Object(a.b)(v,{slug:y,tabs:d,currentTab:C}),Object(a.b)(w.a,{padded:!0},n,Object(a.b)(j,{relativePagePath:p})),Object(a.b)(f.a,{pageContext:t,location:o,slug:y,tabs:d,currentTab:C}),Object(a.b)(l.a,null))}}}]);
//# sourceMappingURL=component---src-pages-data-source-tutorial-connector-mdx-4625cb01d354b590757c.js.map